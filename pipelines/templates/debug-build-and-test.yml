steps:
  - task: Bash@3
    displayName: Install Emulator
    inputs:
      filePath: 'pipelines/templates/android-emulator-install.sh'
    condition: succeededOrFailed()

  - task: Gradle@2
    displayName: Build Debug APK
    inputs:
      tasks: 'assembleDebug'
      gradleWrapperFile: 'gradlew'
      publishJUnitResults: false
    condition: succeededOrFailed()

  - task: Bash@3
    displayName: Start Emulator
    inputs:
      filePath: 'pipelines/templates/android-emulator-start.sh'
    condition: succeededOrFailed()

  - task: Gradle@2
    displayName: Build Test APK
    inputs:
      tasks: 'assembleAndroidTest'
      gradleWrapperFile: 'gradlew'
      publishJUnitResults: false
    condition: succeededOrFailed()